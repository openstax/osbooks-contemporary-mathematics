<document xmlns="http://cnx.rice.edu/cnxml">
  <title>Traveling Salesman Problem</title>
  <metadata xmlns:md="http://cnx.rice.edu/mdml">
  <md:title>Traveling Salesman Problem</md:title>
  <md:content-id>m00123</md:content-id>
  <md:uuid>d9b00371-a3a1-4568-9b4b-7110a7c8c96f</md:uuid>
  </metadata>
  <content>
    <figure id="fig-00001">
    <media alt="Three doors are shown side-by-side.">
    <image mime-type="image/jpg" src="../../media/CS_Photo_12_09_001.jpg"/>
    </media>
    <caption>Each door on the route of a traveling salesman can be represented as a vertex on a graph. (credit: "Three in a row, Heriot Row" by Jason Mason/Flickr, CC BY 2.1)</caption>
    </figure>
    <section class="learning-objectives" id="sect-00001">
    <title>Learning Objectives</title>
    <para id="para-00001">After completing this section, you should be able to: </para>
    <list list-type="enumerated" number-style="arabic" id="list-00001">
    <item>Distinguish between brute force algorithms and greedy algorithms.</item>
    <item>List all distinct Hamilton cycles of a complete graph.</item>
    <item>Apply brute force method to solve traveling salesman applications.</item>
    <item>Apply nearest neighbor method to solve traveling salesman applications.</item>
    </list>
    </section>
    <para id="para-00002">We looked at Hamilton cycles and paths in the previous sections <link target-id="sect-00001" document="m00121">Hamilton Cycles</link> and <link target-id="sect-00001" document="m00122">Hamilton Paths</link>. In this section, we will analyze Hamilton cycles in complete weighted graphs to find the shortest route to visit a number of locations and return to the starting point. Besides the many routing applications in which we need the shortest distance, there are also applications in which we search for the route that is least expensive or takes the least time. Here are a few less common applications that you can read about on <link url="https://openstax.org/r/University_of_Waterloo">a website</link> set up by the mathematics department at the University of Waterloo in Ontario, Canada:</para>
    <list bullet-style="bulleted" id="list-00002">
    <item>Design of fiber optic networks</item>
    <item>Minimizing fuel expenses for repositioning satellites</item>
    <item>Development of semi-conductors for microchips</item>
    <item>A technique for mapping mammalian chromosomes in genome sequencing</item>
    </list>
    <para id="para-00003">Before we look at approaches to solving applications like these, let's discuss the two types of algorithms we will use.</para>
    <section id="sect-00002">
    <title>Brute Force and Greedy Algorithms</title>
    <para id="para-00004">An algorithm is a sequence of steps that can be used to solve a particular problem. We have solved many problems in this chapter, and the procedures that we used were different types of algorithms. In this section, we will use two common types of algorithms, a <term id="term-00001">brute force algorithm</term> and a <term id="term-00002">greedy algorithm</term>. A brute force algorithm begins by listing every possible solution and applying each one until the best solution is found. A greedy algorithm approaches a problem in stages, making the apparent best choice at each stage, then linking the choices together into an overall solution which may or may not be the best solution.</para>
    <para id="para-00005">To understand the difference between these two algorithms, consider the tree diagram in <link target-id="fig-00002" document="m00123" />. Suppose we want to find the path from left to right with the largest total sum. For example, branch A in the tree diagram has a sum of <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>10</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>11</mn><mo>+</mo><mn>13</mn><mo>=</mo><mn>36</mn></mrow></math>.</para>
    <figure id="fig-00002" xmlns="http://cnx.rice.edu/cnxml">
    <media alt="A graph has 15 vertices. The vertices are labeled 1 to 15. 10 branches into 2 and 7. 2 branches into 11 and 15. 11 branches into 13 and 8. 15 branches into 1 and 6. 7 branches into 3 and 4. 3 branches into 20 and 14. 4 branches into 11 and 5. 13, 8, 1, 6, 20, 14, 11, and 5 are labeled A to H.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_226.png"/>
    </media>
    <caption>Points Along Different Paths</caption>
    </figure>
    <para id="para-00006">To be certain that you pick the branch with greatest sum, you could list each sum from each of the different branches:</para>
    <para id="para-00007"><emphasis effect="italic">A</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>11</mn><mo>+</mo><mn>13</mn><mo>=</mo><mn>36</mn></math></para>
    <para id="para-00031" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">B</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>11</mn><mo>+</mo><mn>8</mn><mo>=</mo><mn>31</mn></math></para>
    <para id="para-00032" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">C</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>15</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>28</mn></math></para>
    <para id="para-00096" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">D</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>15</mn><mo>+</mo><mn>6</mn><mo>=</mo><mn>33</mn></math></para>
    <para id="para-00097" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">E</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>20</mn><mo>=</mo><mn>40</mn></math></para>
    <para id="para-00098" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">F</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>14</mn><mo>=</mo><mn>34</mn></math></para>
    <para id="para-00099" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">G</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>11</mn><mo>=</mo><mn>32</mn></math></para>
    <para id="para-00100" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="italic">H</emphasis>: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>10</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>5</mn><mo>=</mo><mn>26</mn></math></para>
    <para id="para-00008" xmlns="http://cnx.rice.edu/cnxml">Then we know with certainty that branch <emphasis effect="italic">E</emphasis> has the greatest sum.</para>
    <figure id="fig-00003">
    <media alt="A graph has 15 vertices. The vertices are labeled 1 to 15. 10 branches into 2 and 7. 2 branches into 11 and 15. 11 branches into 13 and 8. 15 branches into 1 and 6. 7 branches into 3 and 4. 3 branches into 20 and 14. 4 branches into 11 and 5. 13, 8, 1, 6, 20, 14, 11, and 5 are labeled A to H. The edges 10 to 7, 7 to 3, and 3 to 20 are highlighted. An arrow from E points to 20.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_227.png"/>
    </media>
    <caption>Branch <emphasis effect="italic">E</emphasis></caption>
    </figure>
    <para id="para-00009">Now suppose that you wanted to find the branch with the highest value, but you only were shown the tree diagram in phases, one step at a time.</para>
    <figure id="fig-00004">
    <media alt="A graph has 3 vertices. The vertices are labeled 10, 2, and 7. 10 branches into 2 and 7. The edge, 10 to 7 is highlighted.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_228.png"/>
    </media>
    <caption>Tree Diagram Phase 1</caption>
    </figure>
    <para id="para-00010">After phase 1, you would have chosen the branch with 10 and 7. So far, you are following the same branch. Let’s look at the next phase.</para>
    <figure id="fig-00005">
    <media alt="A graph has 5 vertices. The vertices are labeled 10, 2, 7, 3, and 4. 10 branches into 2 and 7. 7 branches into 3 and 4. The edges, 10 to 7 and 7 to 4 are highlighted.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_229.png"/>
    </media>
    <caption>Tree Diagram Phase 2</caption>
    </figure>
    <para id="para-00011">After phase 2, based on the information you have, you will choose the branch with 10, 7 and 4. Now, you are following a different branch than before, but it is the best choice based on the information you have. Let’s look at the last phase.</para>
    <figure id="fig-00006">
    <media alt="A graph has 7 vertices. The vertices are labeled 10, 2, 7, 3, 4, 11, and 15. 10 branches into 2 and 7. 7 branches into 3 and 4. 4 branches into 11 and 5. The edges, 10 to 7, 7 to 4, and 4 to 11 are highlighted. 11 and 5 are labeled G and H.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_230.png"/>
    </media>
    <caption>Tree Diagram Phase 3</caption>
    </figure>
    <para id="para-00012">After phase 3, you will choose branch <emphasis effect="italic">G</emphasis> which has a sum of 32.</para>
    <para id="para-00095">The process of adding the values on each branch and selecting the highest sum is an example of a brute force algorithm because all options were explored in detail. The process of choosing the branch in phases, based on the best choice at each phase is a greedy algorithm. Although a brute force algorithm gives us the ideal solution, it can take a very long time to implement. Imagine a tree diagram with thousands or even millions of branches. It might not be possible to check all the sums. A greedy algorithm, on the other hand, can be completed in a relatively short time, and generally leads to good solutions, but not necessarily the ideal solution.</para>
    <example id="exam-00001">
    <title>Distinguishing between Brute Force and Greedy Algorithms</title>
    <exercise id="exer-00001">
    <problem id="prob-00001">
    <para id="para-00013">A cashier rings up a sale for $4.63 cents in U.S. currency. The customer pays with a $5 bill. The cashier would like to give the customer $0.37 in change using the fewest coins possible. The coins that can be used are quarters ($0.25), dimes ($0.10), nickels ($0.05), and pennies ($0.01). The cashier starts by selecting the coin of highest value less than or equal to $0.37, which is a quarter. This leaves <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtext>$</mtext><mn>0.37</mn><mo>−</mo><mtext>$</mtext><mn>0.25</mn><mo>=</mo><mtext>$</mtext><mn>0.12</mn></mrow></math>. The cashier selects the coin of highest value less than or equal to $0.12, which is a dime. This leaves <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtext>$</mtext><mn>0.12</mn><mo>−</mo><mtext>$</mtext><mn>0.10</mn><mo>=</mo><mtext>$</mtext><mn>0.02</mn></mrow></math>. The cashier selects the coin of highest value less than or equal to $0.02, which is a penny. This leaves <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtext>$</mtext><mn>0.02</mn><mo>−</mo><mtext>$</mtext><mn>0.01</mn><mo>=</mo><mtext>$</mtext><mn>0.01</mn></mrow></math>. The cashier selects the coin of highest value less than or equal to $0.01, which is a penny. This leaves no remainder. The cashier used one quarter, one dime, and two pennies, which is four coins. Use this information to answer the following questions.</para>
    <list list-type="enumerated" number-style="arabic" id="list-00003" xmlns="http://cnx.rice.edu/cnxml">
    <item>Is the cashier’s approach an example of a greedy algorithm or a brute force algorithm? Explain how you know.</item>
    <item>The cashier’s solution is the best solution. In other words, four is the fewest number of coins possible. Is this consistent with the results of an algorithm of this kind? Explain your reasoning.</item>
    </list>
    </problem>
    <solution id="sol-00001">
    <list list-type="enumerated" number-style="arabic" id="list-00004">
    <item>The approach the cashier used is an example of a greedy algorithm, because the problem was approached in phases and the best choice was made at each phase. Also, it is not a brute force algorithm, because the cashier did not attempt to list out all possible combinations of coins to reach this conclusion.</item>
    <item>Yes, it is consistent. A greedy algorithm does not always yield the best result, but sometimes it does.</item>
    </list>
    </solution>
    </exercise>
    </example>
    <note class="your-turn" id="note-00001">
    <exercise id="exer-00002">
    <problem id="prob-00002">
    <para id="para-00014"><link class="os-embed" url="#exercise/CM-C12-M9-Q001"/></para>
    </problem>
    </exercise>
    </note>
    </section>
    <section id="sect-00003">
    <title>The Traveling Salesman Problem</title>
    <para id="para-00015">Now let’s focus our attention on the graph theory application known as the <term id="term-00003">traveling salesman problem (TSP)</term> in which we must find the shortest route to visit a number of locations and return to the starting point.</para>
    <para id="para-00016">Recall from <link target-id="sect-00001" document="m00121">Hamilton Cycles</link>, the officer in the U.S. Air Force who is stationed at Vandenberg Air Force base and must drive to visit three other California Air Force bases before returning to Vandenberg. The officer needed to visit each base once. We looked at the weighted graph in <link target-id="fig-00007" document="m00123" /> representing the four U.S. Air Force bases: Vandenberg, Edwards, Los Angeles, and Beal and the distances between them.</para>
    <figure id="fig-00007">
    <media alt="A graph represents the four California air force bases. The graph has four vertices: E, B, V, and L. The edge, E B is labeld 410 miles. The edge, B V is labeled 396 miles. The edge, V L is labeled 159 miles. The edge, L E is labeled 106 miles. The edge, L B is labeled 439 miles. The edge, E V is labeled 207 miles.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_199.png"/>
    </media>
    <caption>Graph of Four California Air Force Bases</caption>
    </figure>
    <para id="para-00017">Any route that visits each base and returns to the start would be a Hamilton cycle on the graph. If the officer wants to travel the shortest distance, this will correspond to a Hamilton cycle of lowest weight. We saw in <link target-id="table-00001" document="m00123" /> that there are six distinct Hamilton cycles (directed cycles) in a complete graph with four vertices, but some lie on the same cycle (undirected cycle) in the graph.</para>
    <table class="numbered" summary=" " id="table-00001">
    <tgroup cols="4">
    <colspec colnum="1" colname="c1" colwidth="1*"/>
    <colspec colnum="2" colname="c2" colwidth="1*"/>
    <colspec colnum="3" colname="c3" colwidth="1*"/>
    <colspec colnum="4" colname="c4" colwidth="1*"/>
    <thead>
    <row>
    <entry>Complete Graph</entry>
    <entry>Cycle</entry>
    <entry>Cycle</entry>
    <entry>Cycle</entry>
    </row>
    </thead>
    <tbody>
    <row>
    <entry><figure class="unnumbered" id="fig-00009">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196a.png"/>
    </media></figure></entry>
    <entry><figure class="unnumbered" id="fig-00010">
    <media alt="A graph has four vertices, a, b, c, and d.  Edges connect a b, b c, c d, d a, a c, and b d. The edges, a c, and b d are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196b.png"/>
    </media></figure></entry>
    <entry><figure class="unnumbered" id="fig-00011">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a d, and b c are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196c.png"/>
    </media></figure></entry>
    <entry><figure class="unnumbered" id="fig-00012">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a b, and d c are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196d.png"/>
    </media></figure></entry>
    </row>
    <row>
    <entry><emphasis effect="bold">Clockwise Hamilton Cycle</emphasis></entry>
    <entry><para id="para-00018"><figure class="unnumbered" id="fig-00013">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a c, and b d are in dashed lines. Directed arrows flow from a to b, b to c, c to d, and d to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196e.png"/>
    </media></figure></para>
    <para id="para-00019"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    <entry xmlns="http://cnx.rice.edu/cnxml"><para id="para-00020"><figure class="unnumbered" id="fig-00014">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, ad, and bc are in dashed lines. Directed edges flow from a to b, b to d, d to c, and c to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196f.png"/>
    </media></figure></para>
    <para id="para-00021"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    <entry xmlns="http://cnx.rice.edu/cnxml"><para id="para-00022"><figure class="unnumbered" id="fig-00015">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a b, and dc are in dashed lines. Directed edges flow from a to c, c to b, b to d, and d to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196g.png"/>
    </media></figure></para>
    <para id="para-00023"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    </row>
    <row xmlns="http://cnx.rice.edu/cnxml">
    <entry><emphasis effect="bold">Counterclockwise Hamilton Cycle</emphasis></entry>
    <entry><para id="para-00024"><figure class="unnumbered" id="fig-00016">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a c, and b d are in dashed lines. Directed edges flow from a to d, d to c, c to b, and b to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196h.png"/>
    </media></figure></para>
    <para id="para-00025"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    <entry xmlns="http://cnx.rice.edu/cnxml"><para id="para-00026"><figure class="unnumbered" id="fig-00017">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a d, and bc are in dashed lines. The directed edges flow from a to c, c to d, d to b, and b to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196i.png"/>
    </media></figure></para>
    <para id="para-00027"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    <entry xmlns="http://cnx.rice.edu/cnxml"><para id="para-00028"><figure class="unnumbered" id="fig-00018">
    <media alt="A graph has four vertices, a, b, c, and d. Edges connect a b, b c, c d, d a, a c, and b d. The edges, a b, and dc are in dashed lines. The edges flow from a to d, d to b, b to c, and c to a.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_196j.png"/>
    </media></figure></para>
    <para id="para-00029"><emphasis effect="italic">a</emphasis> → <emphasis effect="italic">d</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">a</emphasis></para></entry>
    </row>
    </tbody>
    </tgroup>
    <caption xmlns="http://cnx.rice.edu/cnxml">Hamilton Cycles in a Complete Graph with Four Vertices</caption>
    </table>
    <para id="para-00030">Since the distance between bases is the same in either direction, it does not matter if the officer travels clockwise or counterclockwise. So, there are really only three possible distances as shown in <link target-id="fig-00019" document="m00123" />.</para>
    <figure id="fig-00019">
    <media alt="Three graphs represent the four California air force bases. Each graph has four vertices: E, B, V, and L. The edge, E B is labeled 410 miles. The edge, B V is labeled 396 miles. The edge, V L is labeled 159 miles. The edge, L E is labeled 106 miles. The edge, L B is labeled 439 miles. The edge, E V is labeled 207 miles. In the first graph, the edges, E V, and L B are in dashed lines. In the second graph, the edges, E L and B V are in dashed lines. In the third graph, the edges, E B and L V are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_231a.png"/>
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_231b.png"/>
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_231c.png"/>
    </media>
    <caption>Three Possible Distances</caption>
    </figure>
    <para id="para-00033" xmlns="http://cnx.rice.edu/cnxml">The possible distances are:</para>
    <equation class="unnumbered" id="eq-00002"><math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mtable columnalign="left"><mtr><mtd><mn>396</mn><mo>+</mo><mn>410</mn><mo>+</mo><mn>106</mn><mo>+</mo><mn>159</mn><mo>=</mo><mn>1071</mn></mtd></mtr><mtr><mtd><mn>207</mn><mo>+</mo><mn>410</mn><mo>+</mo><mn>439</mn><mo>+</mo><mn>159</mn><mo>=</mo><mn>1215</mn></mtd></mtr><mtr><mtd><mn>396</mn><mo>+</mo><mn>439</mn><mo>+</mo><mn>106</mn><mo>+</mo><mn>207</mn><mo>=</mo><mn>1148</mn></mtd></mtr></mtable></math></equation>
    <para id="para-00034" xmlns="http://cnx.rice.edu/cnxml">So, a Hamilton cycle of least weight is <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">L</emphasis> → <emphasis effect="italic">V</emphasis> (or the reverse direction). The officer should travel from Vandenberg to Beal to Edwards, to Los Angeles, and back to Vandenberg.</para>
    </section>
    <section id="sect-00004" xmlns="http://cnx.rice.edu/cnxml">
    <title>Finding Weights of All Hamilton Cycles in Complete Graphs</title>
    <para id="para-00035">Notice that we listed all of the Hamilton cycles and found their weights when we solved the TSP about the officer from Vandenberg. This is a skill you will need to practice. To make sure you don't miss any, you can calculate the number of possible Hamilton cycles in a complete graph. It is also helpful to know that half of the directed cycles in a complete graph are the same cycle in reverse direction, so, you only have to calculate half the number of possible weights, and the rest are duplicates.</para>
    <note class="formula" id="note-00002">
    <para id="para-00036">In a complete graph with <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi></math> vertices,</para>
    <list list-type="bulleted" id="list-00005" xmlns="http://cnx.rice.edu/cnxml">
    <item>The number of distinct Hamilton cycles is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow></math>.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">There are at most <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></mrow><mn>2</mn></mfrac></mrow></math> different weights of Hamilton cycles.</item>
    </list>
    </note>
    <note class="check-point" id="note-00003" xmlns="http://cnx.rice.edu/cnxml">
    <para id="para-00037"><emphasis effect="italic">TIP! When listing all the distinct Hamilton cycles in a complete graph, you can start them all at any vertex you choose. Remember, the cycle <emphasis effect="italic">a</emphasis> → <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">a</emphasis> is the same cycle as <emphasis effect="italic">b</emphasis> → <emphasis effect="italic">c</emphasis> → <emphasis effect="italic">a</emphasis> → <emphasis effect="italic">b</emphasis> so there is no need to list both.</emphasis></para>
    </note>
    <example id="exam-00002" xmlns="http://cnx.rice.edu/cnxml">
    <title>Calculating Possible Weights of Hamilton Cycles</title>
    <exercise id="exer-00003">
    <problem id="prob-00003">
    <para id="para-00038">Suppose you have a complete weighted graph with vertices <emphasis effect="italic">N, M, O</emphasis>, and <emphasis effect="italic">P</emphasis>.</para>
    <list list-type="enumerated" number-style="arabic" id="list-00006">
    <item>Use the formula <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow></math> to calculate the number of distinct Hamilton cycles in the graph.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">Use the formula <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></mrow><mn>2</mn></mfrac></mrow></math> to calculate the greatest number of different weights possible for the Hamilton cycles.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">Are all of the distinct Hamilton cycles listed here? How do you know?<newline/>
    Cycle 1: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">N</emphasis><newline/>
    Cycle 2: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">N</emphasis><newline/>
    Cycle 3: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">N</emphasis><newline/>
    Cycle 4: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">N</emphasis><newline/>
    Cycle 5: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">N</emphasis><newline/>
    Cycle 6: <emphasis effect="italic">N</emphasis> → <emphasis effect="italic">P</emphasis> → <emphasis effect="italic">O</emphasis> → <emphasis effect="italic">M</emphasis> → <emphasis effect="italic">N</emphasis></item>
    <item xmlns="http://cnx.rice.edu/cnxml">Which pairs of cycles must have the same weights? How do you know?</item>
    </list>
    </problem>
    <solution id="sol-00002">
    <list list-type="enumerated" number-style="arabic" id="list-00007">
    <item>There are 4 vertices; so, <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow></math>. This means there are <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo><mo>=</mo><mrow><mo>(</mo><mrow><mn>4</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo><mo>=</mo><mn>3</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>1</mn><mo>=</mo><mn>6</mn></mrow></math> distinct Hamilton cycles beginning at any given vertex.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">Since <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow></math>, there are <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mrow><mrow><mo>(</mo><mrow><mn>4</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mn>6</mn><mn>2</mn></mfrac><mo>=</mo><mn>3</mn></mrow></math> possible weights.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">Yes, they are all distinct cycles and there are 6 of them.</item>
    <item>Cycles 1 and 6 have the same weight, Cycles 2 and 4 have the same weight, and Cycles 3 and 5 have the same weight, because these pairs follow the same route through the graph but in reverse.</item>
    </list>
    </solution>
    </exercise>
    </example>
    <note class="check-point" id="note-00004">
    <para id="para-00039"><emphasis effect="italic">TIP! When listing the possible cycles, ignore the vertex where the cycle begins and ends and focus on the ways to arrange the letters that represent the vertices in the middle. Using a systematic approach is best; for example, if you must arrange the letters M, O, and P, first list all those arrangements beginning with M, then beginning with O, and then beginning with P, as we did in Example 12.42.</emphasis>
    </para>
    </note>
    <note class="your-turn" id="note-00005">
    <exercise id="exer-00004">
    <problem id="prob-00004">
    <para id="para-00040"><link class="os-embed" url="#exercise/CM-C12-M9-Q002"/></para>
    </problem>
    </exercise>
    </note>
    </section>
    <section id="sect-00005">
    <title>The Brute Force Method</title>
    <para id="para-00041">The method we have been using to find a Hamilton cycle of least weight in a complete graph is a brute force algorithm, so it is called the <term id="term-00004">brute force method</term>. The steps in the brute force method are:</para>
    <para id="para-00042"><emphasis effect="bold">Step 1:</emphasis> Calculate the number of distinct Hamilton cycles and the number of possible weights.</para>
    <para id="para-00043"><emphasis effect="bold">Step 2:</emphasis> List all possible Hamilton cycles.</para>
    <para id="para-00044"><emphasis effect="bold">Step 3:</emphasis> Find the weight of each cycle.</para>
    <para id="para-00045"><emphasis effect="bold">Step 4:</emphasis> Identify the Hamilton cycle of lowest weight.</para>
    <example id="exam-00003">
    <title>Applying the Brute Force Method</title>
    <exercise id="exer-00005">
    <problem id="prob-00005">
    <para id="para-00046">On the next assignment, the air force officer must leave from Travis Air Force base, visit Beal, Edwards, and Vandenberg Air Force bases each exactly once and return to Travis Air Force base. There is no need to visit Los Angeles Air Force base. Use <link target-id="fig-00022" document="m00123" /> to find the shortest route.</para>
    <figure id="fig-00022">
    <media alt="A graph represents the five California air force bases. The graph has five vertices: E, B, V, L, and T. The edge, E B is labeled 410 miles. The edge, B V is labeled 396 miles. The edge, V L is labeled 159 miles. The edge, L E is labeled 106 miles. The edge, L B is labeled 439 miles. The edge, E V is labeled 207 miles. The edge, E T is labeled 370 miles. The edge, L T is labeled 396 miles. The edge, B T is labeled 84 miles. The edge, V T is labeled 396 miles.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_232.png"/>
    </media>
    <caption>Distances between Five California Air Force Bases</caption>
    </figure>
    </problem>
    <solution id="sol-00003">
    <para id="para-00047"><emphasis effect="bold">Step 1:</emphasis> Since there are 4 vertices, there will be <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mn>4</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo><mo>=</mo><mn>3</mn><mo>!</mo><mo>=</mo><mn>6</mn></mrow></math> cycles, but half of them will be the reverse of the others; so, there will be <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>4</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mn>6</mn><mn>2</mn></mfrac><mo>=</mo><mn>3</mn></mrow></math> possible distances.</para>
    <para id="para-00048" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 2:</emphasis> List all the Hamilton cycles in the subgraph of the graph in <link target-id="fig-00023" document="m00123" />.</para>
    <figure id="fig-00023">
    <media alt="A graph represents four cities. The graph has five vertices: E, B, V, L, and T. The edge, E B is labeled 410 miles. The edge, B V is labeled 396 miles. The edge, V L is labeled 159 miles. The edge, L E is labeled 106 miles. The edge, L B is labeled 439 miles. The edge, E V is labeled 207 miles. The edge, E T is labeled 370 miles. The edge, L T is labeled 396 miles. The edge, B T is labeled 84 miles. The edge, V T is labeled 396 miles. The edges, E L, L V, L B, and L T are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_233.png"/>
    </media>
    <caption>Subgraph with Cities <emphasis effect="italic">B, E, T</emphasis>, and <emphasis effect="italic">V</emphasis></caption>
    </figure>
    <para id="para-00049">To find the 6 cycles, focus on the three vertices in the middle, <emphasis effect="italic">B, E,</emphasis> and <emphasis effect="italic">V</emphasis>. The arrangements of these vertices are <emphasis effect="italic">BEV, BVE, EBV, EVB, VBE</emphasis>, and <emphasis effect="italic">VEB</emphasis>. These would correspond to the 6 cycles:</para>
    <para id="para-00101">1: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00102" xmlns="http://cnx.rice.edu/cnxml">2: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00103" xmlns="http://cnx.rice.edu/cnxml">3: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00104" xmlns="http://cnx.rice.edu/cnxml">4: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00105" xmlns="http://cnx.rice.edu/cnxml">5: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00106" xmlns="http://cnx.rice.edu/cnxml">6: <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">T</emphasis></para>
    <para id="para-00050" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 3:</emphasis> Find the weight of each path. You can reduce your work by observing the cycles that are reverses of each other.</para>
    <para id="para-00107">1: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>84</mn><mo>+</mo><mn>410</mn><mo>+</mo><mn>207</mn><mo>+</mo><mn>396</mn><mo>=</mo><mn>1097</mn></math></para>
    <para id="para-00108" xmlns="http://cnx.rice.edu/cnxml">2: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>84</mn><mo>+</mo><mn>396</mn><mo>+</mo><mn>207</mn><mo>+</mo><mn>370</mn><mo>=</mo><mn>1071</mn></math></para>
    <para id="para-00109" xmlns="http://cnx.rice.edu/cnxml">3: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mn>370</mn><mo>+</mo><mn>410</mn><mo>+</mo><mn>396</mn><mo>+</mo><mn>396</mn><mo>=</mo><mn>1572</mn></math></para>
    <para id="para-00110" xmlns="http://cnx.rice.edu/cnxml">4: Reverse of cycle 2, 1071</para>
    <para id="para-00111">5: Reverse of cycle 3, 1572</para>
    <para id="para-00112">6: Reverse of cycle 1, 1097</para>
    <para id="para-00051" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 4:</emphasis> Identify a Hamilton cycle of least weight.</para>
    <para id="para-00052">The second path, <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">T</emphasis>, and its reverse, <emphasis effect="italic">T</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">V</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">T</emphasis>, have the least weight. The solution is that the officer should travel from Travis Air Force base to Beal Air Force Base, to Vandenberg Air Force base, to Edwards Air Force base, and return to Travis Air Force base, or the same route in reverse.</para>
    </solution>
    </exercise>
    </example>
    <note class="your-turn" id="note-00006" xmlns="http://cnx.rice.edu/cnxml">
    <exercise id="exer-00006">
    <problem id="prob-00006">
    <para id="para-00053"><link class="os-embed" url="#exercise/CM-C12-M9-Q003"/></para>
    </problem>
    </exercise>
    </note>
    <para id="para-00054">Now suppose that the officer needed a cycle that visited all 5 of the Air Force bases in <link target-id="fig-00022" document="m00123" />. There would be <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mn>5</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo><mo>=</mo><mn>4</mn><mo>!</mo><mo>=</mo><mn>4</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>1</mn><mo>=</mo><mn>24</mn></mrow></math> different arrangements of vertices and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>5</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mrow><mn>4</mn><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mrow><mn>24</mn></mrow><mn>2</mn></mfrac><mo>=</mo><mn>12</mn></mrow></math> distances to compare using the brute force method. If you consider 10 Air Force bases, there would be <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mn>10</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo><mo>=</mo><mn>9</mn><mo>!</mo><mo>=</mo><mn>9</mn><mo>⋅</mo><mn>8</mn><mo>⋅</mo><mn>7</mn><mo>⋅</mo><mn>6</mn><mo>⋅</mo><mn>5</mn><mo>⋅</mo><mn>4</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>1</mn><mo>=</mo><mn>362</mn><mo>,</mo><mn>880</mn></mrow></math> different arrangements and <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mrow><mo>(</mo><mrow><mn>10</mn><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mrow><mn>9</mn><mo>!</mo></mrow><mn>2</mn></mfrac><mo>=</mo><mfrac><mrow><mn>9</mn><mo>⋅</mo><mn>8</mn><mo>⋅</mo><mn>7</mn><mo>⋅</mo><mn>6</mn><mo>⋅</mo><mn>5</mn><mo>⋅</mo><mn>4</mn><mo>⋅</mo><mn>3</mn><mo>⋅</mo><mn>2</mn><mo>⋅</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo>=</mo><mn>181</mn><mo>,</mo><mn>440</mn></mrow></math> distances to consider. There must be another way!</para>
    </section>
    <section id="sect-00006" xmlns="http://cnx.rice.edu/cnxml">
    <title>The Nearest Neighbor Method</title>
    <para id="para-00055">When the brute force method is impractical for solving a traveling salesman problem, an alternative is a greedy algorithm known as the <term id="term-00005">nearest neighbor method</term>, which always visit the closest or least costly place first. This method finds a Hamilton cycle of relatively low weight in a complete graph in which, at each phase, the next vertex is chosen by comparing the edges between the current vertex and the remaining vertices to find the lowest weight. Since the nearest neighbor method is a greedy algorithm, it usually doesn’t give the best solution, but it usually gives a solution that is "good enough." Most importantly, the number of steps will be the number of vertices. That’s right! A problem with 10 vertices requires 10 steps, not 362,880. Let’s look at an example to see how it works.</para>
    <para id="para-00056">Suppose that a candidate for governor wants to hold rallies around the state. They plan to leave their home in city <emphasis effect="italic">A</emphasis>, visit cities <emphasis effect="italic">B, C, D, E</emphasis>, and <emphasis effect="italic">F</emphasis> each once, and return home. The airfare between cities is indicated in the graph in <link target-id="fig-00024" document="m00123" />.</para>
    <figure id="fig-00024">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. An edge from E to F is labeled 350 dollars.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_234.png"/>
    </media>
    <caption>Airfares between Cities <emphasis effect="italic">A, B, C, D, E</emphasis>, and <emphasis effect="italic">F</emphasis></caption>
    </figure>
    <para id="para-00057">Let’s help the candidate keep costs of travel down by applying the nearest neighbor method to find a Hamilton cycle that has a reasonably low weight. Begin by marking starting vertex as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> for "visited 1st." Then to compare the weights of the edges between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">A</emphasis> and vertices adjacent to <emphasis effect="italic">A</emphasis>: $250, $210, $300, $200, and $100 as shown in <link target-id="fig-00025" document="m00123" />. The lowest of these is $100, which is the edge between <emphasis effect="italic">A</emphasis> and <emphasis effect="italic">F</emphasis>.</para>
    <figure id="fig-00025">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. An edge from E to F is labeled 350 dollars. The edges from A are in dashed lines. A is labeled V 1.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_235.png"/>
    </media>
    <caption>Finding the Second Vertex</caption>
    </figure>
    <para id="para-00058">Mark <emphasis effect="italic">F</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math> for "visited 2nd" then compare the weights of the edges between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">F</emphasis> and the remaining vertices adjacent to <emphasis effect="italic">F</emphasis>: $170, $330, $150 and $350 as shown in <link target-id="fig-00026" document="m00123" />. The lowest of these is $150, which is the edge between <emphasis effect="italic">F</emphasis> and <emphasis effect="italic">D</emphasis>.</para>
    <figure id="fig-00026">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. An edge from E to F is labeled 350 dollars. The edges from F are in dashed lines. A is labeled V 1. F is labeled V 2.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_236.png"/>
    </media>
    <caption>Finding the Third Vertex</caption>
    </figure>
    <para id="para-00059">Mark <emphasis effect="italic">D</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>3</mn></msub></mrow></math> for "visited 3rd." Next, compare the weights of the edges between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">D</emphasis> and the remaining vertices adjacent to <emphasis effect="italic">D</emphasis>: $120, $310, and $270 as shown in <link target-id="fig-00027" document="m00123" />. The lowest of these is $120, which is the edge between <emphasis effect="italic">D</emphasis> and <emphasis effect="italic">B</emphasis>.</para>
    <figure id="fig-00027">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. A is labeled V 1. F is labeled V 2. D is labeled V 3. The edges, B D, C D, and D E are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_237.png"/>
    </media>
    <caption>Finding the Fourth Vertex</caption>
    </figure>
    <para id="para-00060">So, mark <emphasis effect="italic">B</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>4</mn></msub></mrow></math> for "visited 4th." Finally, compare the weights of the edges between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">B</emphasis> and the remaining vertices adjacent to <emphasis effect="italic">B</emphasis>: $160 and $220 as shown in <link target-id="fig-00028" document="m00123" />. The lower amount is $160, which is the edge between <emphasis effect="italic">B</emphasis> and <emphasis effect="italic">E</emphasis>.</para>
    <figure id="fig-00028">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. A is labeled V 1. F is labeled V 2. D is labeled V 3. B is labeled V 4. The edges, B E and B C are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_238.png"/>
    </media>
    <caption>Finding the Fifth Vertex</caption>
    </figure>
    <para id="para-00061">Now you can mark <emphasis effect="italic">E</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>5</mn></msub></mrow></math> and mark the only remaining vertex, which is <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">C</emphasis>, as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>6</mn></msub></mrow></math>. This is shown in <link target-id="fig-00029" document="m00123" xmlns="http://cnx.rice.edu/cnxml" />. Make a note of the weight of the edge from <emphasis effect="italic">E</emphasis> to <emphasis effect="italic">C</emphasis>, which is $180, and from <emphasis effect="italic">C</emphasis> back to <emphasis effect="italic">A</emphasis>, which is $210.</para>
    <figure id="fig-00029" xmlns="http://cnx.rice.edu/cnxml">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 250 dollars, 210 dollars, 300 dollars, 200 dollars, and 100 dollars. Edges from B leading to C, D, E, and F are labeled 220 dollars, 120 dollars, 160 dollars, and 170 dollars. Edges from C to D, E, and F are labeled 310 dollars, 180 dollars, and 330 dollars. Edges from D to E and F 270 dollars and 150 dollars. A is labeled V 1. F is labeled V 2. D is labeled V 3. B is labeled V 4. E is labeled V 5. C is labeled V 6. The edges, A C, and E C are in dashed lines.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_239.png"/>
    </media>
    <caption>Finding the Sixth Vertex</caption>
    </figure>
    <para id="para-00062">The Hamilton cycle we found is <emphasis effect="italic">A</emphasis> → <emphasis effect="italic">F</emphasis> → <emphasis effect="italic">D</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">C</emphasis> → <emphasis effect="italic">A</emphasis>. The weight of the circuit is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mtext>$</mtext><mn>100</mn><mo>+</mo><mtext>$</mtext><mn>150</mn><mo>+</mo><mtext>$</mtext><mn>120</mn><mo>+</mo><mtext>$</mtext><mn>160</mn><mo>+</mo><mtext>$</mtext><mn>180</mn><mo>+</mo><mtext>$</mtext><mn>210</mn><mo>=</mo><mtext>$</mtext><mn>920</mn></mrow></math>. This may or may not be the route with the lowest cost, but there is a good chance it is very close since the weights are most of the lowest weights on the graph and we found it in six steps instead of finding 120 different Hamilton cycles and calculating 60 weights. Let’s summarize the procedure that we used.</para>
    <para id="para-00063" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 1:</emphasis> Select the starting vertex and label <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> for "visited 1st." Identify the edge of lowest weight between <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math> and the remaining vertices.</para>
    <para id="para-00064" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 2:</emphasis> Label the vertex at the end of the edge of lowest weight that you found in previous step as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mi>n</mi></msub></mrow></math> where the subscript n indicates the order the vertex is visited. Identify the edge of lowest weight between <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mi>n</mi></msub></mrow></math> and the vertices that remain to be visited.</para>
    <para id="para-00065" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 3:</emphasis> If vertices remain that have not been visited, repeat Step 2. Otherwise, a Hamilton cycle of low weight is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub><mo>→</mo><msub><mi>V</mi><mn>2</mn></msub><mo>→</mo><mo>⋯</mo><mo>→</mo><msub><mi>V</mi><mi>n</mi></msub><mo>→</mo><msub><mi>V</mi><mn>1</mn></msub></mrow></math>.</para>
    <example id="exam-00004" xmlns="http://cnx.rice.edu/cnxml">
    <title>Using the Nearest Neighbor Method</title>
    <exercise id="exer-00007">
    <problem id="prob-00007">
    <para id="para-00066">Suppose that the candidate for governor wants to hold rallies around the state but time before the election is very limited. They would like to leave their home in city <emphasis effect="italic">A</emphasis>, visit cities <emphasis effect="italic">B</emphasis>, <emphasis effect="italic">C</emphasis>, <emphasis effect="italic">D</emphasis>, <emphasis effect="italic">E</emphasis>, and <emphasis effect="italic">F</emphasis> each once, and return home. The airfare between cities is not as important as the time of travel, which is indicated in <link target-id="fig-00030" document="m00123" />. Use the nearest neighbor method to find a route with relatively low travel time. What is the total travel time of the route that you found?</para>
    <figure id="fig-00030">
    <media alt="A graph represents the airfares between six different cities. The graph has 6 vertices. The vertices are A, B, C, D, E, and F. Edges from A leading to B, C, D, E, and F are labeled 120 minutes, 140 minutes, 85 minutes, 90 minutes, and 180 minutes. Edges from B leading to C, D, E, and F are labeled 100 minutes, 80 minutes, 95 minutes, and 110 minutes. Edges from C to D, E, and F are labeled 220 minutes, 200 minutes, and 75 minutes. Edges from D to E and F are labeled 130 minutes and 70 minutes. An edge from E to F is labeled 210 minutes.">
    <image mime-type="image/png" src="../../media/CS_Figure_12_09_240.png"/>
    </media>
    <caption>Travel Times between Cities <emphasis effect="italic">A, B, C, D, E</emphasis> and <emphasis effect="italic">F</emphasis></caption>
    </figure>
    </problem>
    <solution id="sol-00004">
    <para id="para-00067"><emphasis effect="bold">Step 1:</emphasis> Label vertex <emphasis effect="italic">A</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>1</mn></msub></mrow></math>. The edge of lowest weight between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">A</emphasis> and the remaining vertices is 85 min between <emphasis effect="italic">A</emphasis> and <emphasis effect="italic">D</emphasis>.</para>
    <para id="para-00068" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 2:</emphasis> Label vertex <emphasis effect="italic">D</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>2</mn></msub></mrow></math>. The edge of lowest weight between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">D</emphasis> and the vertices that remain to be visited, <emphasis effect="italic">B, C, E</emphasis>, and <emphasis effect="italic">F</emphasis>, is 70 min between <emphasis effect="italic">D</emphasis> and <emphasis effect="italic">F</emphasis>.</para>
    <para id="para-00069" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Repeat Step 2:</emphasis> Label vertex <emphasis effect="italic">F</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>3</mn></msub></mrow></math>. The edge of lowest weight between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">F</emphasis> and the vertices that remain to be visited, <emphasis effect="italic">B, C,</emphasis> and <emphasis effect="italic">E</emphasis>, is 75 min between <emphasis effect="italic">F</emphasis> and <emphasis effect="italic">C</emphasis>.</para>
    <para id="para-00070" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Repeat Step 2:</emphasis> Label vertex <emphasis effect="italic">C</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>4</mn></msub></mrow></math>. The edge of lowest weight between <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">C</emphasis> and the vertices that remain to be visited, <emphasis effect="italic">B</emphasis> and <emphasis effect="italic">E</emphasis>, is 100 min between <emphasis effect="italic">C</emphasis> and <emphasis effect="italic">B</emphasis>.</para>
    <para id="para-00071" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Repeat Step 2:</emphasis> Label vertex <emphasis effect="italic">B</emphasis> as <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><msub><mi>V</mi><mn>5</mn></msub></mrow></math>. The only vertex that remains to be visited is <emphasis effect="italic" xmlns="http://cnx.rice.edu/cnxml">E</emphasis>. The weight of the edge between <emphasis effect="italic">B</emphasis> and <emphasis effect="italic">E</emphasis> is 95 min.</para>
    <para id="para-00072" xmlns="http://cnx.rice.edu/cnxml"><emphasis effect="bold">Step 3:</emphasis> A Hamilton cycle of low weight is <emphasis effect="italic">A</emphasis> → <emphasis effect="italic">D</emphasis> → <emphasis effect="italic">F</emphasis> → <emphasis effect="italic">C</emphasis> → <emphasis effect="italic">B</emphasis> → <emphasis effect="italic">E</emphasis> → <emphasis effect="italic">A</emphasis>. So, a route of relatively low travel time is <emphasis effect="italic">A</emphasis> to <emphasis effect="italic">D</emphasis> to <emphasis effect="italic">F</emphasis> to <emphasis effect="italic">C</emphasis> to <emphasis effect="italic">B</emphasis> to <emphasis effect="italic">E</emphasis> and back to <emphasis effect="italic">A</emphasis>. The total travel time of this route is: <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mn>85</mn><mspace width="0.28em"/><mi>min</mi><mo>+</mo><mn>70</mn><mspace width="0.28em"/><mi>min</mi><mo>+</mo><mn>75</mn><mspace width="0.28em"/><mi>min</mi><mo>+</mo><mn>100</mn><mspace width="0.28em"/><mi>min</mi><mo>+</mo><mn>95</mn><mspace width="0.28em"/><mi>min</mi><mo>+</mo><mn>90</mn><mspace width="0.28em"/><mi>min</mi><mo>=</mo><mn>515</mn><mspace width="0.28em"/><mi>min</mi><mi>or</mi><mspace width="0.28em"/><mn>8</mn><mspace width="0.28em"/><mi>hrs</mi><mspace width="0.28em"/><mn>35</mn><mspace width="0.28em"/><mi>min</mi></mrow></math></para>
    </solution>
    </exercise>
    </example>
    <note class="your-turn" id="note-00007" xmlns="http://cnx.rice.edu/cnxml">
    <exercise id="exer-00008">
    <problem id="prob-00008">
    <para id="para-00073"><link class="os-embed" url="#exercise/CM-C12-M9-Q004"/></para>
    </problem>
    </exercise>
    </note>
    </section>
    <section class="check-understanding" id="sect-00007">
    <title>Check Your Understanding</title>
    <exercise id="exer-00009">
    <problem id="prob-00009">
    <para id="para-00074"><link class="os-embed" url="#exercise/CM-C12-M9-Q005"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00010">
    <problem id="prob-00010">
    <para id="para-00075"><link class="os-embed" url="#exercise/CM-C12-M9-Q017"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00011">
    <problem id="prob-00011">
    <para id="para-00076"><link class="os-embed" url="#exercise/CM-C12-M9-Q018"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00012">
    <problem id="prob-00012">
    <para id="para-00077"><link class="os-embed" url="#exercise/CM-C12-M9-Q019"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00013">
    <problem id="prob-00013">
    <para id="para-00078"><link class="os-embed" url="#exercise/CM-C12-M9-Q020"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00014">
    <problem id="prob-00014">
    <para id="para-00079"><link class="os-embed" url="#exercise/CM-C12-M9-Q021"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00015">
    <problem id="prob-00015">
    <para id="para-00080"><link class="os-embed" url="#exercise/CM-C12-M9-Q022"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00016">
    <problem id="prob-00016">
    <para id="para-00081"><link class="os-embed" url="#exercise/CM-C12-M9-Q023"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00017">
    <problem id="prob-00017">
    <para id="para-00082"><link class="os-embed" url="#exercise/CM-C12-M9-Q024"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00018">
    <problem id="prob-00018">
    <para id="para-00083"><link class="os-embed" url="#exercise/CM-C12-M9-Q025"/></para>
    </problem>
    </exercise>
    </section>
    <section class="section-exercises" id="sect-00008">
    <exercise id="exer-00019">
    <problem id="prob-00019">
    <para id="para-00084"><link class="os-embed" url="#exercise/CM-C12-M9-Q006"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00020">
    <problem id="prob-00020">
    <para id="para-00085"><link class="os-embed" url="#exercise/CM-C12-M9-Q007"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00021">
    <problem id="prob-00021">
    <para id="para-00086"><link class="os-embed" url="#exercise/CM-C12-M9-Q008"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00022">
    <problem id="prob-00022">
    <para id="para-00087"><link class="os-embed" url="#exercise/CM-C12-M9-Q009"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00023">
    <problem id="prob-00023">
    <para id="para-00088"><link class="os-embed" url="#exercise/CM-C12-M9-Q010"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00024">
    <problem id="prob-00024">
    <para id="para-00089"><link class="os-embed" url="#exercise/CM-C12-M9-Q011"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00025">
    <problem id="prob-00025">
    <para id="para-00090"><link class="os-embed" url="#exercise/CM-C12-M9-Q012"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00026">
    <problem id="prob-00026">
    <para id="para-00091"><link class="os-embed" url="#exercise/CM-C12-M9-Q013"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00027">
    <problem id="prob-00027">
    <para id="para-00092"><link class="os-embed" url="#exercise/CM-C12-M9-Q014"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00028">
    <problem id="prob-00028">
    <para id="para-00093"><link class="os-embed" url="#exercise/CM-C12-M9-Q015"/></para>
    </problem>
    </exercise>
    <exercise id="exer-00029">
    <problem id="prob-00029">
    <para id="para-00094"><link class="os-embed" url="#exercise/CM-C12-M9-Q016"/></para>
    </problem>
    </exercise>
    </section>
    <section class="key-terms" id="sect-00009">
    <title>Key Terms</title>
    <list id="list-00008">
    <item>brute force algorithm</item>
    <item>greedy algorithm</item>
    <item>traveling salesman problem (TSP)</item>
    <item>brute force method</item>
    <item>nearest neighbor method</item>
    </list>
    </section>
    <section class="key-concepts" id="sect-00010">
    <title>Key Concepts</title>
    <list id="list-00009">
    <item>A brute force algorithm always finds the ideal solution but can be impractical whereas a greedy algorithm is efficient but usually does not lead to the ideal solution.</item>
    <item>A Hamilton cycle of lowest weight is a solution to the traveling salesman problem.</item>
    <item>The brute force method finds a Hamilton cycle of lowest weight in a complete graph.</item>
    <item>The nearest neighbor method is a greedy algorithm that finds a Hamilton cycle of relatively low weight in a complete graph.</item>
    </list>
    </section>
    <section class="formula-review" id="sect-00011">
    <title>Formulas</title>
    <list bullet-style="bulleted" id="list-00010">
    <item>In a complete graph with <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi></math> vertices, the number of distinct Hamilton cycles is <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mrow><mo>(</mo><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow><mo>)</mo></mrow><mo>!</mo></mrow></math>.</item>
    <item xmlns="http://cnx.rice.edu/cnxml">In a complete graph with <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mi>n</mi></math> vertices, there are at most <math xmlns="http://www.w3.org/1998/Math/MathML" display="inline"><mrow><mfrac><mrow><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>!</mo></mrow><mn>2</mn></mfrac></mrow></math> different weights of Hamilton cycles.</item>
    </list>
    </section>
    </content> 
    </document>     